<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <link rel="stylesheet" href="./resources/ol.css">
        <link rel="stylesheet" href="resources/fontawesome-all.min.css">
        <link href="resources/photon-geocoder-autocomplete.min.css" rel="stylesheet">
        <link rel="stylesheet" href="./resources/ol-layerswitcher.css">
        <link rel="stylesheet" href="./resources/qgis2web.css">
        <style>
        html, body {
            background-color: #ffffff;                              
        }
        .ol-control > * {
            background-color: #f8f8f8!important;
            color: #444444!important;
            border-radius: 0px;
        }
        .ol-attribution a, .gcd-gl-input::placeholder, .search-layer-input-search::placeholder {
            color: #444444!important;
        }
        .search-layer-input-search {
            background-color: #f8f8f8!important;
        }
        .ol-control > *:focus, .ol-control >*:hover {
            background-color: rgba(248, 248, 248, 0.7)!important;
        } 
        .ol-control {
            background-color: rgba(255,255,255,.4) !important;
            padding: 2px !important;
        } 
        </style>

        <style>
        html, body, #map {
            position: relative;
            width: 100%;
            height: 100%;
            padding: 0;
            margin: 0;
        }
        #info-button {
            position: fixed;
            bottom: 10px;
            left: 10px;
            z-index: 1000;
            padding: 6px 10px;
            background: white;
            border: 1px solid #444;
            cursor: pointer;
        }
        #info-panel {
            position: fixed;
            bottom: 50px;
            left: 10px;
            width: 260px;
            background: white;
            border: 1px solid #444;
            padding: 10px;
            display: none;
            z-index: 1001;
        }
        #intro-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.85);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 1;
            transition: opacity 0.6 ease;
        }
        #intro-screen.fade-out {
            opacity: 0;
            pointer-events: none;
        }
        #intro-box {
            background: white;
            padding: 20px 30px;
            border: 1px solid #aaa;
            text-align: center;
            border-radius: 6px;
        }
        #enter-map {
            margin-top: 15px;
            padding: 8px 16px;
            cursor: pointer;
            background-color: #1976d2;
            color: #fff;
            border: none;
            border-radius: 4px;
        }
        #enter-map:hover {
            background-color: #145ca3;
        }
        #logo-cpts {
            width: 150px;
            margin: 10px auto 15px auto;
            display: block;
        }
        #snow {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
        }
        .snowflake {
            position: absolute;
            top: -20px;
            color: white;
            pointer-events: none;
            font-size: 12px;
            animation-name: fall;
            animation-timing-function: linear;
            animation-iteration-count: infinite;
        }
        @keyframes fall {
            from { transform : translateY(-10px); }
            to { transform : translateY(110vh); }
        }
        </style>
        <title></title>
    </head>
    <body>
        <div id="intro-screen">
            <div id="intro-box">
                <h2>Bienvenue sur la carte interactive de l'offre de santé à Bagneux</h2>
                <img src="images/logocpts.png" id="logo-cpts" alt="Logo CPTS">
                <p>Par défaut, seuls les médecins généralistes, le CMS et les pharmacies sont affichés. Vous pouvez afficher les spécialités médicales de votre choix grâce à la légende en haut à droite.</p>
                <p>Utilisez les boutons + et - pour zoomer et dézoomer, et survolez les points (version ordinateur) pour voir les informations détaillées. En version mobile, il suffit de toucher les points pour voir les détails.</p>
                <button id="enter-map">Accéder à la carte</button>
                </div>
                </div>
        <div id="map" class="map">
        <div id="snow"></div>
        </div>
        <button id="info-button">Informations</button>
        <div id="info-panel">
            <strong>À propos de la carte :</strong><br><br>
            Le territoire de Bagneux dispose d'une offre de santé variée (données octobre 2025).<br><br>

            Pour utiliser la carte :<br><br>
            - Zoomez/dézoomez avec les boutons + et -<br><br>
            - Survolez les points pour voir les détails et accéder au site web si disponible.<br><br>
            
            Carte mise à disposition par la CPTS de Bagneux. Données publiques, mises en forme avec QGIS.
            </div>
            <div id="popup" class="ol-popup">
                <a href="#" id="popup-closer" class="ol-popup-closer"></a>
                <div id="popup-content"></div>
            </div>
        <script src="resources/qgis2web_expressions.js"></script>
        <script>
            // Attendre que le DOM soit prêt
            document.addEventListener('DOMContentLoaded', function(){
                var enter = document.getElementById('enter-map');
                var screen = document.getElementById('intro-screen');
                if (!enter || !screen) return;
                enter.addEventListener('click', function () {
                    screen.classList.add('fade-out');
                    setTimeout(function() {
                        screen.style.display = 'none';
                    }, 650);
                });
            });
            </script>
        <script>
            const btn = document.getElementById('info-button');
            const panel = document.getElementById('info-panel');

            btn.onclick = function () {
                if (panel.style.display === 'none'){
                    panel.style.display = 'block';
                } else {
                    panel.style.display = 'none';
                }
            };
            </script>
<script src="resources/proj4.js"></script>
        <script>proj4.defs('IGNF:RGF93LAMB93.IGN69','+proj=lcc +lat_0=46.5 +lon_0=3 +lat_1=44 +lat_2=49 +x_0=700000 +y_0=6600000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +vunits=m +no_defs');</script>
        <script src="./resources/functions.js"></script>
        <script src="./resources/ol.js"></script>
        <script src="./resources/ol-layerswitcher.js"></script>
        <script src="resources/photon-geocoder-autocomplete.min.js"></script>
        <script src="layers/CommunedeBagneux_1.js"></script><script src="layers/Ergothrapeutes_2.js"></script><script src="layers/Ditticiens_3.js"></script><script src="layers/Pdicurespodologues_4.js"></script><script src="layers/Psychologues_5.js"></script><script src="layers/Orthophonistes_6.js"></script><script src="layers/Infirmiers_7.js"></script><script src="layers/Ostopathes_8.js"></script><script src="layers/Masseurskinsithrapeutes_9.js"></script><script src="layers/Chirurgiensdentistes_10.js"></script><script src="layers/Traumatologue_11.js"></script><script src="layers/Echographiste_12.js"></script><script src="layers/Radiologue_13.js"></script><script src="layers/Ophtalmologues_14.js"></script><script src="layers/Gyncologues_15.js"></script><script src="layers/Dermatologues_16.js"></script><script src="layers/Cardiologues_17.js"></script><script src="layers/Mdecinsgnralistes_18.js"></script><script src="layers/CentreMunicipaldeSantCMS_19.js"></script><script src="layers/Pharmacies_20.js"></script>
        <script src="styles/CommunedeBagneux_1_style.js"></script><script src="styles/Ergothrapeutes_2_style.js"></script><script src="styles/Ditticiens_3_style.js"></script><script src="styles/Pdicurespodologues_4_style.js"></script><script src="styles/Psychologues_5_style.js"></script><script src="styles/Orthophonistes_6_style.js"></script><script src="styles/Infirmiers_7_style.js"></script><script src="styles/Ostopathes_8_style.js"></script><script src="styles/Masseurskinsithrapeutes_9_style.js"></script><script src="styles/Chirurgiensdentistes_10_style.js"></script><script src="styles/Traumatologue_11_style.js"></script><script src="styles/Echographiste_12_style.js"></script><script src="styles/Radiologue_13_style.js"></script><script src="styles/Ophtalmologues_14_style.js"></script><script src="styles/Gyncologues_15_style.js"></script><script src="styles/Dermatologues_16_style.js"></script><script src="styles/Cardiologues_17_style.js"></script><script src="styles/Mdecinsgnralistes_18_style.js"></script><script src="styles/CentreMunicipaldeSantCMS_19_style.js"></script><script src="styles/Pharmacies_20_style.js"></script>
        <script src="./layers/layers.js" type="text/javascript"></script> 
        <script src="./resources/Autolinker.min.js"></script>
        <script src="./resources/qgis2web.js"></script>
        <!-- Effet neige-->
        <div id="snow"></div>
        <script>
            const snowContainer = document.getElementById("snow");
            for (let i = 0; i < 40; i++) {
                let flake = document.createElement("div");
                flake.className = "snowflake";
                flake.textContent = "❄";
                flake.style.left = Math.random() * 100 + "vw";
                flake.style.fontSize = (Math.random() * 12 + 8) + "px";
                flake.style.animationDuration = (Math.random() * 3 + 2) + "s";
                flake.style.animationDelay = Math.random() * 5 + "s";
                flake.style.color = Math.random() < 0.5? "#ffffff" : "#80c0ff";
                if (Math.random() < 0.5) {
                    flake.style.animationName = "fall, rotate";
                    flake.style.animationDuration = `${(Math.random() * 5 + 3)}s, ${(Math.random() * 5 + 2)}s`;
                } else {
                 flake.style.animationName = "fall";
                }
                snowContainer.appendChild(flake);
            }
            </script>
    </body>
</html>
